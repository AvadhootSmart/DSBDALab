Alright, let's move at full speed! 🚀  
Here’s the **full HiveQL code** + **ready notes** you can use for the **Flight Information System** practical.

---

# 📜 HiveQL Code for Flight Information System

---

## 1. **Create Database**

```sql
CREATE DATABASE IF NOT EXISTS flight_db;
USE flight_db;
```

---

## 2. **Create Tables**

### a. Create Internal Table

```sql
CREATE TABLE IF NOT EXISTS flight_info (
    flight_id STRING,
    flight_date STRING,
    departure_time STRING,
    departure_delay INT,
    arrival_time STRING,
    arrival_delay INT,
    origin STRING,
    destination STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;
```

---

### b. Create External Table

```sql
CREATE EXTERNAL TABLE IF NOT EXISTS flight_info_ext (
    flight_id STRING,
    flight_date STRING,
    departure_time STRING,
    departure_delay INT,
    arrival_time STRING,
    arrival_delay INT,
    origin STRING,
    destination STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
LOCATION '/user/hive/warehouse/flight_info_ext';
```

✅ **Note:** Make sure your HDFS location `/user/hive/warehouse/flight_info_ext` exists and has the data.

---

## 3. **Load Data into Internal Table**

(Assuming your CSV file is uploaded into HDFS `/user/hive/warehouse/flight_data.csv`.)

```sql
LOAD DATA INPATH '/user/hive/warehouse/flight_data.csv' INTO TABLE flight_info;
```

---

## 4. **Insert New Values**

```sql
INSERT INTO TABLE flight_info VALUES
('F101', '2008-01-01', '0600', 5, '0800', 0, 'JFK', 'LAX');
```

---

## 5. **Alter Table: Add New Column**

```sql
ALTER TABLE flight_info ADD COLUMNS (flight_duration INT);
```

---

## 6. **Join Operation Example**

Suppose you create another table:

```sql
CREATE TABLE IF NOT EXISTS airport_info (
    airport_code STRING,
    airport_name STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY ','
STORED AS TEXTFILE;
```

Join query:

```sql
SELECT f.flight_id, f.origin, a.airport_name
FROM flight_info f
JOIN airport_info a
ON (f.origin = a.airport_code);
```

---

## 7. **Create an Index**

```sql
CREATE INDEX idx_departure_delay
ON TABLE flight_info (departure_delay)
AS 'COMPACT' 
WITH DEFERRED REBUILD;
```

Then:

```sql
ALTER INDEX idx_departure_delay ON flight_info REBUILD;
```

---

## 8. **Find Average Departure Delay per Day (in 2008)**

```sql
SELECT flight_date, AVG(departure_delay) AS avg_departure_delay
FROM flight_info
WHERE flight_date LIKE '2008%'
GROUP BY flight_date
ORDER BY flight_date;
```

---

# ✍️ Quick Viva Notes

---

## Q1. What is an Internal Table in Hive?
> **Internal Table** → Data is managed by Hive.  
> If you drop the table, **data gets deleted** from HDFS too.

---

## Q2. What is an External Table in Hive?
> **External Table** → Data is **managed externally**.  
> Dropping the table does **NOT delete the data** from HDFS.

---

## Q3. What is the purpose of creating an Index in Hive?
> ➔ Index improves **query performance**.  
> ➔ Helps in **faster search and retrieval** on large datasets.

---

## Q4. How do you calculate average delay per day?
> ➔ **Group by `flight_date`** and **take `AVG(departure_delay)`**.

---

## Q5. What file format and delimiter are used here?
> ➔ **TEXTFILE** format.  
> ➔ **Comma `,`** delimiter.

---

# 📌 Summary you can say at start of viva:

_"In this practical, I created internal and external tables for the flight information system, loaded and manipulated flight data, performed joins with airport information, created an index on departure delays, and calculated the average departure delay per day for 2008 using HiveQL."_

---

✅ That covers full practical + full viva!  
(Also covers all tasks a, b, c, d, e.)

---

Would you also like me to make a **small sample `flight_data.csv` file** you can immediately load if they ask you to demo? 📄🚀  
(Will match exactly this table structure.)  
Should I?
